--DROP TABLE CART_DETAILS;
--DROP TABLE ORDERS;
CREATE TABLE CART_DETAILS(
		BOOK_ID INTEGER NOT NULL,
		CUSTOMER_ID INTEGER NOT NULL,
		SHOP_ID INTEGER NOT NULL,
		PRICE_PER_BOOK NUMBER NOT NULL,
		CONSTRAINT CART_DETAILS_PK PRIMARY KEY(BOOK_ID, CUSTOMER_ID),
		CONSTRAINT CART_DETAILS_CUSTOMER_FK FOREIGN KEY(CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_id)
		ON DELETE CASCADE,
		CONSTRAINT CART_DETAILS_BOOK_FK FOREIGN KEY(book_id) REFERENCES BOOK(book_id)
		ON DELETE CASCADE,
		CONSTRAINT CART_DETAILS_SHOP_FK FOREIGN KEY(shop_id) REFERENCES SHOP(SHOP_id)
		ON DELETE CASCADE
);

CREATE TABLE ORDERS(
		ORDER_ID INTEGER generated by DEFAULT AS identity(start with 1000000045 INCREMENT BY 2),
		SHOP_ID INTEGER NOT NULL,
		book_id INTEGER NOT NULL,
		CUSTOMER_ID INTEGER NOT NULL,
		QUANTITY NUMBER NOT NULL,
		TOTAL_PRICE NUMBER NOT NULL,
		TRANSACTION_ID VARCHAR2(100) NOT NULL,
		ADDRESS_ID INTEGER NOT NULL,
		CONSTRAINT ORDERS_PK PRIMARY KEY(order_id),
		CONSTRAINT ORDERS_CUSTOMER_FK FOREIGN KEY(CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_id)
		ON DELETE CASCADE,
		CONSTRAINT ORDERS_BOOK_FK FOREIGN KEY(book_id) REFERENCES BOOK(book_id)
		ON DELETE CASCADE,
		CONSTRAINT ORDERS_SHOP_FK FOREIGN KEY(shop_id) REFERENCES SHOP(SHOP_id)
		ON DELETE CASCADE,
		CONSTRAINT ORDERS_ADDRESS_FK FOREIGN KEY(ADDRESS_ID) REFERENCES ADDRESS_DETAIL(ADDRESS_ID)
		ON DELETE CASCADE
);
