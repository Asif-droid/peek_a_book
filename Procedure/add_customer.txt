CREATE OR replace PROCEDURE add_customer(fname IN VARCHAR2, lname IN VARCHAR2, cemail IN VARCHAR2, astreet IN VARCHAR2, athana IN VARCHAR2, apostal_code IN VARCHAR2, dname IN VARCHAR2) IS
dist_id INTEGER ;
a_id INTEGER ;
i INTEGER ;
j INTEGER ;
BEGIN
		--add district
		i := 0;
		FOR R IN (SELECT DISTRICT_NAME FROM DISTRICT) 
		LOOP
				IF UPPER(R.DISTRICT_NAME)= UPPER(dname) THEN
						i :=1;
			  END IF;
				EXIT WHEN i=1; 
		END LOOP;
		IF i=0 THEN
				INSERT INTO DISTRICT(DISTRICT_NAME) VALUES(dname);
		END IF;
		SELECT DISTRICT_ID INTO dist_id FROM DISTRICT WHERE UPPER(DISTRICT_NAME)= UPPER(dname);
		DBMS_OUTPUT.PUT_LINE(dist_id);
		
		--Add_Address
		j := 0;
		FOR R1 IN (SELECT STREET FROM ADDRESS_DETAIL) 
		LOOP
				IF UPPER(R1.STREET)= UPPER(astreet) THEN
						j :=1;
			  END IF;
				EXIT WHEN j=1; 
		END LOOP;
		IF j=0 THEN
				INSERT INTO ADDRESS_DETAIL(street, thana, postal_code, DISTRICT_ID) VALUES(astreet, athana, apostal_code, dist_id);
		END IF;
		SELECT ADDRESS_ID INTO a_id FROM ADDRESS_DETAIL WHERE UPPER(street)= UPPER(astreet);
		DBMS_OUTPUT.PUT_LINE(a_id);
		INSERT INTO CUSTOMER(first_name, last_name, email, address_id) VALUES(fname, lname, cemail, a_id);	
END;

DECLARE
BEGIN
		add_customer('basak', 'samson', 'skbasak123@gmail.com', 'kalidash len', 'koilash', 5422, 'Urissha');
END;